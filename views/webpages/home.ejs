<!doctype html>
<html lang="zxx">

<head>
	<!-- Required meta tags -->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<title><%=title%></title>
<link rel="shortcut icon" type="image/x-icon" href="/images-removebg-preview (2).png" />
<link rel="stylesheet" href="assets/css/style-starter.css">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- Bootstrap Icons (optional for user icon) -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" rel="stylesheet">
<!-- Animate.css for animations -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
<!-- Bootstrap Icons or FontAwesome for play icon -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<!-- Owl Carousel CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.theme.default.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />


<style>
  .btn-brown {
    background-color: #8B4513; /* saddle brown */
    border: none;
  }
  .btn-brown:hover, 
  .btn-brown:focus {
    background-color: #5C2E00; /* darker brown */
    color: #fff;
  }
  .img-hover-scale {
    transition: transform 0.4s ease;
  }
  .img-hover-scale:hover {
    transform: scale(1.05);
  }
  .play-btn {
    background-color: rgba(0, 0, 0, 0.4);
    border: none;
    border-radius: 50%;
    padding: 10px 14px;
    transition: transform 0.3s ease;
  }
  .play-btn:hover {
    transform: scale(1.2);
    background-color: rgba(0, 0, 0, 0.6);
  }
  .btn-brown {
    background-color: #6f4e37;
    border: none;
  }
  .btn-brown:hover {
    background-color: #5a3f2d;
  }
  .owl-carousel .item {
    margin: 15px;
  }
</style>
<!-- SweetAlert2 -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body style="background-color: rgb(205, 218, 213);">
	<!-- header -->
	<header id="site-header" class="w3l-header fixed-top">
		<!--/nav-->
		<%-include('../layout/user_layout/navbar.ejs')%>
		
	</header>
	<!--/breadcrumbs -->
	<!-- main-slider -->
	<section class="w3l-main-slider position-relative" id="home" style="margin-top: 40px;">
		<div class="companies20-content">
			<div class="owl-one owl-carousel owl-theme">
				<div class="item">
					<li>
						<div class="slider-info banner-view bg bg2">
							<div class="banner-info">
								<h3>Latest Movie Trailers</h3>
								<p>Lorem ipsum dolor sit amet consectetur adipisicing elit.<span class="over-para">
										Consequuntur hic odio
										voluptatem tenetur consequatur.</span></p>
								<a href="#small-dialog1" class="popup-with-zoom-anim play-view1">
									<span class="video-play-icon">
										<span class="fa fa-play"></span>
									</span>
									<h6>Watch Trailer</h6>
								</a>
								<div id="small-dialog1" class="zoom-anim-dialog mfp-hide">
									<iframe src="https://player.vimeo.com/video/358205676" allow="autoplay; fullscreen"
										allowfullscreen=""></iframe>
								</div>
							</div>
						</div>
					</li>
				</div>
				<div class="item">
					<li>
						<div class="slider-info  banner-view banner-top1 bg bg2">
							<div class="banner-info">
								<h3>Latest Online Movies</h3>
								<p>Lorem ipsum dolor sit amet consectetur adipisicing elit.<span class="over-para">
										Consequuntur hic odio
										voluptatem tenetur consequatur.</span></p>
								<a href="#small-dialog2" class="popup-with-zoom-anim play-view1">
									<span class="video-play-icon">
										<span class="fa fa-play"></span>
									</span>
									<h6>Watch Trailer</h6>
								</a>
								<div id="small-dialog2" class="zoom-anim-dialog mfp-hide">
									<iframe src="https://player.vimeo.com/video/395376850" allow="autoplay; fullscreen"
										allowfullscreen=""></iframe>
								</div>
							</div>
						</div>
					</li>
				</div>
				<div class="item">
					<li>
						<div class="slider-info banner-view banner-top2 bg bg2">
							<div class="banner-info">
								<h3>Latest Movie Trailers</h3>
								<p>Lorem ipsum dolor sit amet consectetur adipisicing elit.<span class="over-para">
										Consequuntur hic odio
										voluptatem tenetur consequatur.</span></p>
								<a href="#small-dialog3" class="popup-with-zoom-anim play-view1">
									<span class="video-play-icon">
										<span class="fa fa-play"></span>
									</span>
									<h6>Watch Trailer</h6>
								</a>
								<div id="small-dialog3" class="zoom-anim-dialog mfp-hide">
									<iframe src="https://player.vimeo.com/video/389969665" allow="autoplay; fullscreen"
										allowfullscreen=""></iframe>
								</div>
							</div>
						</div>
					</li>
				</div>
				<div class="item">
					<li>
						<div class="slider-info banner-view banner-top3 bg bg2">
							<div class="banner-info">
								<h3>Latest Online Movies</h3>
								<p>Lorem ipsum dolor sit amet consectetur adipisicing elit.<span class="over-para">
										Consequuntur hic odio
										voluptatem tenetur consequatur.</span></p>
								<a href="#small-dialog4" class="popup-with-zoom-anim play-view1">
									<span class="video-play-icon">
										<span class="fa fa-play"></span>
									</span>
									<h6>Watch Trailer</h6>
								</a>
								<div id="small-dialog4" class="zoom-anim-dialog mfp-hide">
									<iframe src="https://player.vimeo.com/video/323491174" allow="autoplay; fullscreen"
										allowfullscreen=""></iframe>
								</div>
							</div>
						</div>
					</li>
				</div>
			</div>
		</div>
	</section>
	<!-- main-slider -->
	<!--grids-sec1-->
<section class="w3l-grids">
  <div class="grids-main py-5">
    <div class="container py-lg-3">
      <!-- Section Header -->
      <div class="headerhny-title">
        <div class="w3l-title-grids d-flex justify-content-between align-items-center">
          <div class="headerhny-left">
            <h2 class="mb-4 fw-bold animate__animated animate__fadeInDown">Popular Events</h2>
          </div>
          <div class="headerhny-right">
            <h4><a class="show-title" href="/events">Show all</a></h4>
          </div>
        </div>
      </div>

      <!-- Event Cards -->
      <div class="row">
        <% popularevent.forEach((event, index) => { %>
          <div class="col-md-4 mb-4 animate__animated animate__zoomIn animate__delay-<%= index %>s">
            <div class="card shadow border-0 h-100" style="max-width: 300px; margin: auto;">
              <div class="position-relative overflow-hidden">
                <img src="/images/<%= event.image[0] %>" class="card-img-top img-hover-scale" alt="<%= event.name %>">

                <!-- Play Button -->
                <button class="btn play-btn position-absolute top-50 start-50 translate-middle"
                        data-bs-toggle="modal"
                        data-bs-target="#videoModal"
                        data-video="/videos/<%= event.videos[0] %>">
                  <i class="fa fa-play-circle fa-3x text-white"></i>
                </button>
              </div>

              <!-- Event Info -->
              <a href="/detailse/event/<%= event.eventId %>" style="text-decoration: none; color: black;">
                <div class="card-body">
                  <h5 class="card-title"><%= event.name %></h5>
                  <p class="text-muted mb-1">Category: <%= event.category %></p>
                  <p class="mb-0"><i class="fa fa-star text-warning"></i> <%= event.avgRating * 2 %> | <%= event.reviewCount %> Reviews</p>
                </div>
              </a>
            </div>
          </div>
        <% }) %>
      </div>
    </div>
  </div>

  <!-- Video Modal -->
  <div class="modal fade" id="videoModal" tabindex="-1" aria-labelledby="videoModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content bg-dark">
        <div class="modal-header border-0">
          <h5 class="modal-title text-white">Event Trailer</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body p-0">
          <!-- Responsive Video Container -->
          <div class="ratio ratio-16x9">
            <video id="eventVideo" controls class="w-100 h-100">
              <source src="" type="video/mp4">
              Your browser does not support the video tag.
            </video>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- jQuery and Bootstrap Script -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
  $(document).ready(function () {
    // Load and play video when play button clicked
    $('[data-bs-target="#videoModal"]').on('click', function () {
      const videoSrc = $(this).data('video');
      const videoElement = $('#eventVideo');
      videoElement.find('source').attr('src', videoSrc);
      videoElement[0].load();
      videoElement[0].play();
    });

    // Pause and reset video when modal closed
    $('#videoModal').on('hidden.bs.modal', function () {
      const videoElement = $('#eventVideo')[0];
      videoElement.pause();
      videoElement.currentTime = 0;
    });
  });
</script>

	<!-- Popular Movies Section -->
<section class="container py-5">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="fw-bold animate__animated animate__fadeInDown">Popular Movies</h2>
    <h4><a class="show-title" href="/movies">Show all</a></h4>
  </div>
  <div class="owl-carousel owl-theme" id="popular-movies-carousel">
    <% popularmovie.forEach((movie) => { %>
      <div class="item" style="height: 400px; width: 300px;">
        <div class="card shadow border-0 h-100" style="width: 300px;">
          <div class="position-relative overflow-hidden">
            <img src="/images/<%= movie.poster[0] %>" class="card-img-top img-hover-scale" alt="<%= movie.title %>" height="300px" width="300px">

            <!-- Play Trailer Button -->
            
             <a class="btn play-btn position-absolute top-50 start-50 translate-middle" href="/show_traller/<%=movie._id%>"> 
                <i class="fa fa-play-circle fa-3x text-white"></i>
              </a>
           
          </div>
          <a href="/single-event/<%= movie.movieId %>" style="text-decoration: none; color: black;">
            <div class="card-body">
              <h5 class="card-title"><%= movie.title %></h5>
              <p class="text-muted mb-1">Language: <%= movie.genre.join(", ") %></p>
              <p class="mb-0"><i class="fa fa-star text-warning"></i> <%= movie.avgRating %> / 10</p>
            </div>
          </a>
        </div>
      </div>
    <% }); %>
  </div>
</section>



	<section class="position-relative overflow-hidden" style="min-height: 400px;">
  <!-- Background video -->
  <video autoplay muted loop playsinline
    class="position-absolute top-0 start-0 w-100 h-100 object-fit-cover"
    style="z-index: -1;">
    <source src="/your-video.mp4" type="video/mp4" />
    <!-- fallback image -->
    <img src="assets/images/fallback.jpg" alt="Background Video Fallback" />
  </video>

  <div class="container py-5 position-relative text-white">
	  <h2 class="mb-4 text-center">New Released Movies</h2>
    <div class="owl-carousel owl-theme owl-mid" id="movie-slider">

      <!-- Loop through each movie -->
      <% newrelishedmovie.forEach(movie => { 
          // Extract info
          const genreBadge = movie.genre && movie.genre.length ? movie.genre[0] : 'Genre';
          const releaseYear = new Date(movie.releaseDate).getFullYear();
          
          // Duration seconds to hh mm
          const totalSeconds = parseInt(movie.duration) || 0;
          const hours = Math.floor(totalSeconds / 3600);
          const minutes = Math.floor((totalSeconds % 3600) / 60);
          const durationFormatted = `${hours > 0 ? hours + 'h ' : ''}${minutes}m`;

          // First poster image path - assume /uploads/movies/
          const posterImg = movie.posters && movie.posters.length ? `/images/${movie.posters[0]}` : 'assets/images/default-movie.jpg';

          // First trailer link placeholder (you might replace with actual trailer URL)
          const trailerUrl = movie.trailers && movie.trailers.length ? `/show_traller/${movie._id || ''}` : '#';
      %>
      <div class="item px-3" style="color: black;">
        <div class="bg-dark bg-opacity-50 rounded p-4" style="background-image: url('<%= posterImg %>'); background-size: cover; background-position: center;">
          <span class="badge bg-warning text-dark mb-2"><%= genreBadge %></span>
          <h3 class="fw-bold"><%= movie.name %></h3>
          <p class="mb-3"><%= releaseYear %> ‧ <%= movie.genre.join('/') %> ‧ <%= durationFormatted %></p>
          <a href="<%= trailerUrl %>" class="btn btn-outline-light" target="_blank" rel="noopener noreferrer">
            <i class="fa fa-play me-2"></i> Watch Trailer
          </a>
        </div>
      </div>
      <% }) %>

    </div>
  </div>
</section>


	<!-- Footer -->
	<%- include("../layout/user_layout/footer.ejs") %>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js"></script>

<script>
  $(document).ready(function () {
    $("#popular-movies-carousel").owlCarousel({
      loop: true,
      margin: 20,
      nav: true,
      dots: false,
      autoplay: true,
      autoplayTimeout: 3000,
      responsive: {
        0: { items: 1 },
        600: { items: 2 },
        992: { items: 3 },
        1200: { items: 4 }
      },
      navText: [
        "<i class='fa fa-chevron-left'></i>",
        "<i class='fa fa-chevron-right'></i>"
      ]
    });

    // Movie Trailer Modal Logic
    $('#movieVideoModal').on('show.bs.modal', function (event) {
      var button = $(event.relatedTarget);
      var videoSrc = button.data('video');
      $('#movieVideoPlayer').attr('src', videoSrc);
    });

    $('#movieVideoModal').on('hidden.bs.modal', function () {
      $('#movieVideoPlayer').attr('src', '');
    });
  });
</script>

</body>
</html>
<!--/theme-change-->
<script src="assets/js/theme-change.js"></script>
<script src="assets/js/owl.carousel.js"></script>
<!-- script for banner slider-->
<!-- responsive tabs -->
<script src="assets/js/jquery-1.9.1.min.js"></script>
<script src="assets/js/easyResponsiveTabs.js"></script>
<script type="text/javascript">
	$(document).ready(function () {
		//Horizontal Tab
		$('#parentHorizontalTab').easyResponsiveTabs({
			type: 'default', //Types: default, vertical, accordion
			width: 'auto', //auto or any width like 600px
			fit: true, // 100% fit in a container
			tabidentify: 'hor_1', // The tab groups identifier
			activate: function (event) { // Callback function if tab is switched
				var $tab = $(this);
				var $info = $('#nested-tabInfo');
				var $name = $('span', $info);
				$name.text($tab.text());
				$info.show();
			}
		});
	});
</script>
<!--/theme-change-->
<script src="assets/js/theme-change.js"></script>
<script src="assets/js/owl.carousel.js"></script>
<!-- script for banner slider-->
<script>
	$(document).ready(function () {
		$('.owl-one').owlCarousel({
			stagePadding: 280,
			loop: true,
			margin: 20,
			nav: true,
			responsiveClass: true,
			autoplay: true,
			autoplayTimeout: 5000,
			autoplaySpeed: 1000,
			autoplayHoverPause: false,
			responsive: {
				0: {
					items: 1,
					stagePadding: 40,
					nav: false
				},
				480: {
					items: 1,
					stagePadding: 60,
					nav: true
				},
				667: {
					items: 1,
					stagePadding: 80,
					nav: true
				},
				1000: {
					items: 1,
					nav: true
				}
			}
		})
	})
</script>
<script>
	$(document).ready(function () {
		$('.owl-three').owlCarousel({
			loop: true,
			margin: 20,
			nav: false,
			responsiveClass: true,
			autoplay: true,
			autoplayTimeout: 5000,
			autoplaySpeed: 1000,
			autoplayHoverPause: false,
			responsive: {
				0: {
					items: 2,
					nav: false
				},
				480: {
					items: 2,
					nav: true
				},
				667: {
					items: 3,
					nav: true
				},
				1000: {
					items: 5,
					nav: true
				}
			}
		})
	})
</script>
<script>
	$(document).ready(function () {
		$('.owl-mid').owlCarousel({
			loop: true,
			margin: 0,
			nav: false,
			responsiveClass: true,
			autoplay: true,
			autoplayTimeout: 5000,
			autoplaySpeed: 1000,
			autoplayHoverPause: false,
			responsive: {
				0: {
					items: 1,
					nav: false
				},
				480: {
					items: 1,
					nav: false
				},
				667: {
					items: 1,
					nav: true
				},
				1000: {
					items: 1,
					nav: true
				}
			}
		})
	})
</script>
<!-- script for owlcarousel -->
<script src="assets/js/jquery.magnific-popup.min.js"></script>
<script>
	$(document).ready(function () {
		$('.popup-with-zoom-anim').magnificPopup({
			type: 'inline',

			fixedContentPos: false,
			fixedBgPos: true,

			overflowY: 'auto',

			closeBtnInside: true,
			preloader: false,

			midClick: true,
			removalDelay: 300,
			mainClass: 'my-mfp-zoom-in'
		});

		$('.popup-with-move-anim').magnificPopup({
			type: 'inline',

			fixedContentPos: false,
			fixedBgPos: true,

			overflowY: 'auto',

			closeBtnInside: true,
			preloader: false,

			midClick: true,
			removalDelay: 300,
			mainClass: 'my-mfp-slide-bottom'
		});
	});
</script>
<!-- disable body scroll which navbar is in active -->
<script>
	$(function () {
		$('.navbar-toggler').click(function () {
			$('body').toggleClass('noscroll');
		})
	});
</script>
<!-- disable body scroll which navbar is in active -->

<!--/MENU-JS-->
<script>
	$(window).on("scroll", function () {
		var scroll = $(window).scrollTop();

		if (scroll >= 80) {
			$("#site-header").addClass("nav-fixed");
		} else {
			$("#site-header").removeClass("nav-fixed");
		}
	});

	//Main navigation Active Class Add Remove
	$(".navbar-toggler").on("click", function () {
		$("header").toggleClass("active");
	});
	$(document).on("ready", function () {
		if ($(window).width() > 991) {
			$("header").removeClass("active");
		}
		$(window).on("resize", function () {
			if ($(window).width() > 991) {
				$("header").removeClass("active");
			}
		});
	});
</script>

<script src="assets/js/bootstrap.min.js"></script>